{% extends 'base.html' %}
{% block content %}
<div class="row " style="padding-top:30px">
    <div class="col-8 no-gutters" style="padding: 0">
        <div id="map"></div>
    </div>
    <div class="overflow-auto col-4 no-gutters" style="max-height: 870px; max-width: 100%; padding: 0">
        {% for element in zdarzenie %}
        {% if element.typ == "bitwa" %}
        <div class="card text-white bg-danger" id="element{{ element.ogc_fid }}" style="border: 1px solid white">
        {% else %}
        <div class="card text-white bg-primary" id="element{{ element.ogc_fid }}">
        {% endif %}
            <div class="card-body">
                <h5 class="card-title">{{ element.nazwa }}</h5>
                <h6 class="card-text"> {{ element.data }}</h6>
                
                <p class="card-text">
                    {% if element.str_kon_1 is not NULL %}
                    Strona konfliktu: {{ element.str_kon_1 }}
                    <br>
                    {% endif %}
                    {% if element.dowod_1 is not NULL %}
                    Dowódca: {{ element.dowod_1 }}
                    <br>
                    {% endif %}
                    {% if element.str_kon_2 is not NULL %}
                    Druga strona konfliktu: {{ element.str_kon_2 }}
                    <br>
                    {% endif %}
                    {% if element.dowod_2 is not NULL %}
                    Dowódca: {{ element.dowod_2 }}
                    <br>
                    {% endif %}
                    {% if element.zwyciestwo is not NULL %}
                    Zwyciestwo: {{ element.zwyciestwo }}
                    <br>
                    {% endif %}
                </p>
                <p class="card-text"> {{ element.opis }}</p>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
{% block scripts %}
    var osm = new ol.layer.Tile({
        source: new ol.source.OSM(),
        title: 'OpenStreetMap',
        baseLayer: true,
    });

    var stamen = new ol.layer.Tile({
        source: new ol.source.Stamen({ layer: 'toner' }),
        title: 'Stamen Toner',
        baseLayer: true,
        visible: false
      });

    var style = function(feature, resolution){
        const type = feature.get("typ");
        var color;
        if (type==='bitwa'){ color = 'red' }
        else if (type==='wydarzenie'){ color='blue' }
        else { color='green' }

        return new ol.style.Style({
            image: new ol.style.Circle({
                fill: new ol.style.Fill({ color: color}),
                    stroke: new ol.style.Stroke ({color: 'white', width:1 }),
                    radius: 5
                })
            })
        };

    var wojna_trzydziestoletnia = new ol.layer.Vector({
        source: new ol.source.Vector({
            format: new ol.format.GeoJSON(),
            url: '/geojson/wojna_trzydziestoletnia/'
        }),
        title:'Wojna Trzydziestoletnia',
        style: style,
        name: 'wojna_trzydziestoletnia',
    });

    var map = new ol.Map({
        target: 'map',
        layers: [osm, stamen, wojna_trzydziestoletnia],
        view: new ol.View({
            center: ol.proj.fromLonLat([18, 51.35]),
            zoom: 8
        })
    });



    var legend = new ol.control.LayerSwitcher();
    map.addControl (legend);
{% endblock %}